<div class="fullscreen flex flex-col bg-slate-400 md:p-6">
  <div class="md:self-center md:w-1/2 lg:w-1/3 flex-1 flex flex-col md:shadow-2xl">
    <!-- navbar start -->

    <div class="bg-blue-900 flex flex-row items-center gap-3 p-3 sticky top-0 md:rounded">
      <div (click)="router.navigate([''])" class="flex flex-row gap-3 items-center cursor-pointer">
        <i class="pi pi-arrow-left text-white font-bold text-xl"></i>
        <p-avatar
          [image]="user().profile.profileImage" 
          size="xlarge" 
          shape="circle"
          class="flex flex-col"
        />
      </div>
      <span class="text-white">
        {{user().profile.firstName}} {{user().profile.surname}}
      </span>
    </div>

    <!-- navbar end -->
    
    <app-messages
      [userId]="user()._id"
      [onFetch]="fetchState().running"
      [messages]="fetchState().result"
      [isError]="fetchState().isError"
      (requestResend)="resend($event)"
      class="flex-1 overflow-x-auto gap-3 p-6 flex flex-col {{fetchState().isError ? 'center':''}} "
    />

    <app-send-message 
      (send)="send($event)"
      [uploading]="uploading"
      [newMessage]="newMessage"
      [isRunning]="sendState().running"
      [isValid]="isValid.test(newMessage.value.value)"
      (upload)="upload($event)"
      class="sticky bottom-0"
    />
  </div>  

</div>

<!-- 
 
<div class="fullscreen bg-green-300 lg:bg-green-900 flex flex-col">
  <app-navbar
    [image]="routeState.profile.profileImage"
    [firstName]="routeState.profile.firstName"
    [surname]="routeState.profile.surname"
    [connected]="connected"
    [_id]="_id"
    page="message"
  />
  <app-messages
    [userId]="user()._id"
    [onFetch]="fetchState().running"
    [messages]="fetchState().result"
    [isError]="fetchState().isError"
    (requestResend)="resend($event)"
    class="flex-1 overflow-x-auto gap-3 p-6 mt-[88px] mb-[74px] flex flex-col {{fetchState().isError ? 'center':''}} "
  />
  <app-send-message 
    (send)="send($event)"
    [uploading]="uploading"
    [newMessage]="newMessage"
    [isRunning]="sendState().running"
    [isValid]="isValid.test(newMessage.value.value)"
    (upload)="upload($event)"
  />
  <p-dialog header="Send" [(visible)]="visible" [modal]="true">
    <div class="flex flex-col gap-3">
      <img
        [src]="imageMessage.value.value" 
        alt="Image"
        class="h-72 aspect-square rounded"
      />
      <form [formGroup]="imageMessage" (submit)="sendImage(imageMessage)">
        <p-inputGroup class="flex flex-row">
          <input 
            type="text" 
            pInputText 
            placeholder="Description"
            class="flex-1 px-3 outline-none"
            formControlName="description"
          />
          <button type="submit" pButton icon="pi pi-send">
          </button>
        </p-inputGroup>
      </form>
    </div>
  </p-dialog>
</div>
 -->